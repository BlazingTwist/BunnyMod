These are my test notes. Feel free to look if you're curious about what I'm working on.

# Scratchpad

- Getting snagged on CanUseChunk. May need to redo this one and pay special attention to returns, since it's a bool.

- AccessTools argument additions (new Type[1] {etc} often missing)
  - Operating Bar error may have been addressed
  - Slot machine may have been addressed

- Run w/ ArcologyEcology & PoliceState:

    ```
    [Message: Bunny Mod] UDManhole List count: 4
    [Info   : Unity Log] Loading Fire Hydrants
    [Info   : Unity Log] Loading Trees
    [Info   : Unity Log] Loading Boulders
    [Info   : Unity Log] Loading Bushes
    [Info   : Unity Log] Set RecentlyFadedOut False
    [Error  : Unity Log] NullReferenceException: Object reference not set to an instance of an object
    Stack trace:
    BunnyMod.Content.BMTraits.StatusEffects_BecomeHidden (ObjectReal hiddenInObject, StatusEffects __instance) (at <6db2a189c9f94358a13f920d7777c3e6>:0)
    StatusEffects.BecomeHidden (ObjectReal hiddenInObject) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
    BunnyMod.Content.BMLevelGen+<LoadLevel_SetupMore3_3_Prefix_Replacement>d__31.MoveNext () (at <6db2a189c9f94358a13f920d7777c3e6>:0)
    BunnyMod.Content.BMLevelGen+<LoadLevel_SetupMore3_3_Postfix>d__32.MoveNext () (at <6db2a189c9f94358a13f920d7777c3e6>:0)
    UnityEngine.SetupCoroutine.InvokeMoveNext (System.Collections.IEnumerator enumerator, System.IntPtr returnValueAddress) (at <73b499366e5241bda47e5da76897738b>:0)
    ```

## Mutators

- Arcoloy Ecology
  - Ambient audio stopped working
    - Attempted
- MACITS
  - More happy/nature chunks
    - Greenhouse
    - Music Hall
  - Cops not annoyed at property damage
  - More musicians
  - Doctors are free
  - Replace Slum Dwellers and Upper-Crusters with Workers
  - No Thieves or Gangbangers
  - Vending machines almost all free
  - Chunks
    - No mansions/ gated communities/ Shacks
      - Replaced with simple houses and apartments
    - No arenas
    - No banks
    - No casinos
    - No churches
    - No Confiscation/Deportation Centers
    - No slave shops
    - No Zoos
- AnCapistan
  - Many XP rewards converted into money rewards
  - Objects now cost money
    - Alarm Buttons 
      - Attempted
            ```
            [Message: Bunny Mod] ObjectReal_Interact: AlarmButton (1664)
            [Message: Bunny Mod] AlarmButton_DetermineButtons
            [Warning:  HarmonyX] AccessTools.DeclaredMethod: Could not find method for type ObjectReal and name Interact and parameters ()
            [Error  : Unity Log] NullReferenceException: Object reference not set to an instance of an object
            Stack trace:
            BunnyMod.Content.BunnyHeaderTools.GetMethodWithoutOverrides[T] (System.Reflection.MethodInfo method, System.Object callFrom) (at <6db2a189c9f94358a13f920d7777c3e6>:0)
            BunnyMod.Content.BMObjects.AlarmButton_DetermineButtons (AlarmButton __instance) (at <6db2a189c9f94358a13f920d7777c3e6>:0)
            AlarmButton.DetermineButtons () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            PlayfieldObject.Interact (Agent agent) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            BunnyMod.Content.BMObjects.ObjectReal_Interact (Agent agent, ObjectReal __instance) (at <6db2a189c9f94358a13f920d7777c3e6>:0)
            ObjectReal.Interact (Agent agent) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            AlarmButton.Interact (Agent agent) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            InteractionHelper.UpdateInteractionHelper () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            Updater.UpdateInterface () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            Updater.Update () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
            ```
    - Toilets 
      - Attempted
    - Elevators 
      - Attempted
    - Bathtubs 
    - Fire Hydrants 
      - No effect, but didn't have firefighter
            ```
            [Message: Bunny Mod] ObjectReal_Interact: FireHydrant (1679)
            [Info   : Unity Log] Window Lose Focus
            ```
  - NPCs
    - Firefighters
      - Only respond to fires in certain chunk types
      - Can pay them to put out fires if you want
    - More Thieves
    - More Drug Dealers
    - More Slum Dwellers
    - No Police, Cop Bots, or SuperCops
    - Upper Crusters 
      - Roam with bodyguards
      - Fewer in number
      - All aligned to each other
  - Purchase Admin access on computers
- City of Steel
  - Floor mod worked, but pick a more metallic tile
- Flammable Walls remove Fire Spewer
  - Seemed to work, but no new security cams. That's acceptable, but verify their name.
- Police State
  - Cannibals still spawning
  - Northside cameras spawn facing south
    - May need to bump them a half-tile south to make them detect the wall correctly
  - Enable/Disable chunk types appropriate (like deportation centers)
  - Police hostile to all Guilty NPCs
  - Upper Cruster changes similar to AnCapistan
  - ALL cameras trigger anytime someone guilty is seen, even in public tiles
  - Thieves, Drug Dealers, Mafia & Gangbangers don't roam levels
  - If Cop hostile, gain Wanted for level
  - Disable bribery
- Shanty Town
  - This tileset appears to be bugged
- Spelunky Dory
  - Add random walls to outside of walls, use Trashcan algorithm
- Sunken City
  - Didn't work, grass did
- Transit Experiment
  - Didn't work, grass did
- Wall Mods
  - If SpawnerFloor.spawn works out for floors, you might have a parallel solution for floors in SpawnerWall.spawn
    - Specifically I'm referring to stubborn hideout walls.

## Object Interactions
- Vendor Carts
  - Bar filled, but then the bar just stayed and nothing happened
        ```
        [Message: Bunny Mod] ObjectReal_Interact: VendorCart (2443)
        [Message: Bunny Mod] VendorCart (2443): ObjectReal_PressedButton
        [Message: Bunny Mod] PlayfieldObject_Operating VendorCart (2443):
        [Message: Bunny Mod]     Agent = Playerr
        [Message: Bunny Mod] Logging error
        [Info   : Unity Log] HideInventory Sound Debug: False - False - False - False - False - False
        [Info   : Unity Log] SETRELHATE: Shopkeeper (1242) (Agent) - Playerr (Agent)
        [Message: Bunny Mod] VendorCart (2443): ObjectReal_FinishedOperating
        ```

## Traits

- Stupid 
  - Slower XP Gain
  - Super Stupid 
    - Slower Slower XP Gain Slower
  - Absolute Fucking Moron 
    - Zero XP gain, ever. (100)
    - 
- General Relationship traits
  - Set a gate to exclude the Home Base
    - Attempted
  - Maybe also exclude resistance leaders etc.

- Eagle Eyes
  - NPC activity range needs to be increased
  - Reduce UI scale
    - CanvasScaler.m_ScaleFactor
    - MainGUI.ShowInterfaceAnim
      - This also includes Inventory menus
        - InvSlot.TotalSlotNumber
- Priors
  - No effect
    - This can be directly modelend on Wanted, to ensure completeness of the mod.
  - Ensure all law enforcement follow suit
- Reinforcements/ Reinforcements + 
  -Need a stat boost
- Stealth Bastard Deluxe
  - Hide in Trashcans if you have Diminutive
  - 
        ```
        [Message: Bunny Mod] ObjectReal_Interact: TrashCan (1542)
        [Error  : Unity Log] NullReferenceException: Object reference not set to an instance of an object
        Stack trace:
        PlayfieldObject.Interact (Agent agent) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
        BunnyMod.Content.BMObjects.ObjectReal_Interact (Agent agent, ObjectReal __instance) (at <c1d88de91cc5443cb93433c5a23678a1>:0)
        ObjectReal.Interact (Agent agent) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
        BunnyMod.Content.BMObjects.TrashCan_Interact (Agent agent, TrashCan __instance) (at <c1d88de91cc5443cb93433c5a23678a1>:0)
        TrashCan.Interact (Agent agent) (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
        InteractionHelper.UpdateInteractionHelper () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
        Updater.UpdateInterface () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)
        Updater.Update () (at <5b00a25014d74f7f862ecdd1d48f7c04>:0)

        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] InteractionHelper Error 8-4 ObjectSprite (UnityEngine.GameObject) - TrashCan (1542) (TrashCan)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        [Error  : Unity Log] Error in AgentUpdate: Playerr (Agent)
        ```
- TamperTantrum
  - Amended some apparent errors and clarified some names. Removed ref from arguments, seemed unnecessary .Test.
    - Yep, now it's incrementing it by an incorrect amount. Showed -7, incremented -15.
        ```
        [Message: Bunny Mod] ObjectReal_Interact: Stove (1192)
        [Message: Bunny Mod] ToolCost:
        [Message: Bunny Mod]    agent = Playerr
        [Message: Bunny Mod]    baseCost = 30
        [Message: Bunny Mod] Stove (1192): ObjectReal_PressedButton
        [Message: Bunny Mod] PlayfieldObject_Operating Stove (1192):
        [Message: Bunny Mod]     Agent = Playerr
        [Message: Bunny Mod]     item = Wrench
        [Message: Bunny Mod]     timeToUnlock = 2
        [Message: Bunny Mod]     makeNoise = True
        [Message: Bunny Mod]     barType = Tampering
        [Info   : Unity Log] HideInventory Sound Debug: False - False - False - False - False - False
        [Message: Bunny Mod] Stove (1192): ObjectReal_FinishedOperating
        [Message: Bunny Mod] Stove (1192): Stove_UseWrenchToDetonate
        [Message: Bunny Mod] Stove (1192): ObjectReal_MakeNonFunctional
        [Message: Bunny Mod] InvDatabase_SubtractFromItemCount_d:
        [Message: Bunny Mod]    InvItem = Wrench
        [Message: Bunny Mod]    amount = 30
        [Message: Bunny Mod]    toolbarMove = True
        [Message: Bunny Mod] SkillPoints_AddPointsLate
        [Message: Bunny Mod] SkillPoints_AddPointsLate_IEnumerator:
        [Message: Bunny Mod]    pointsType = TamperGeneratorPoints
        [Message: Bunny Mod]    extraNum = 1
        [Error  : Unity Log] Operating Bar Error 2
        [Message: Bunny Mod]    xpReward = 20
        ```
    -It's possible you're just passing it through that calculation twice, so it's getting cut in half twice for the button label but not the tool increment.
- Underdark Citizen
  - Hiding Cannibals now start out outside of bushes. need to set it so that it affects only Manholes.
    - Attempted
- Warlord
  - No effect

## Shelved Notes

- SlotMachine drop cash:
  - See ObjectReal.DestroyMe2 line 72

- GC.CanalHoles might be a fun thing to switch to positive. Downtown becomes a Skyway district?

- RandomSelection.LoadRandomness is a good place to find lists to modify 

- RogueLibs conflicts not working right
    ```  
    Abbysssal — 
    Available determines whether a trait will exist in the game. 
    IsActive determines whether that trait will appear in the game (can be toggled on/off in the Traits Menu at Home Base).
    I think you should just patch StatusEffects.GetUpgradeTraits
    ```
---

# Implementation Slate


---

# Fixes


---

# Balancing


---

# Finalization
- Do renames *only when the code is complete*.
- Complete and win a run with each new feature, and successfully load a return to home base. This would be a full cycle of the code you can expect to run into.
- Make a promo character for each special ability or trait group, to promote the mod and community at large.
- Update Sprites
- Increment the Version Number!

## Release Notes 

- New Mutators: Shanty Town & City of Steel
- New Traits: Eagle Eyes, Eagle Eyes +, Myopic, Ultramyopic, Underdark Citizen

# Documentation Update Staging

## Mutators

All traits in categories marked with an asterisk (*) are mutually exclusive with the other traits *within* that category.
 
### Floors & Features *

*N.B.: If a chunk uses non-neutral floors, they will not be affected by floor mutators.*

*N.B: These are compatible with Construction mutators, and will overwrite the changes they make to floors.*

✓- This mutator adds the feature to all districts

✗- This mutator prevents the feature from spawning

|Feature                 |Arcology Ecology   |Sunken City    |Transit Experiment |
|:-----------------------|:-----------------:|:-------------:|:-----------------:|
|Neutral Floors          |Grass              |Swimming Pool  |Skating Rink       |
|Alarm Button            |   |   |   |
|Barbecue                |   |   |✗ |
|Bear Trap               |   |   |   |
|Boulder                 |✓ |   |   |
|Bush                    |✓ |   |   |
|Cop                     |   |   |   |
|CopBot                  |   |   |   |
|Exploding SlimeBarrel   |✗ |   |   |
|Fire Hydrant            |   |   |   |
|Flame Grate             |   |   |✗ |
|Flaming Barrel          |   |   |✗ |
|Gangbanger              |   |   |   |
|Hobo                    |   |   |   |
|Lake                    |✓ |   |✗ |
|Lamp                    |   |   |   |
|Lockdown Wall           |   |   |   |
|Mafia                   |   |   |   |
|Manhole                 |   |   |   |
|Mayor                   |   |   |   |
|Mine                    |   |   |   |
|Musician                |   |   |   |
|Oil Spill               |✗ |   |   |
|Police Box              |   |   |   |
|Power Box               |   |   |   |
|SlimeBarrel             |✗ |   |   |
|Tracks                  |   |   |   |
|Trash Can               |✓ |   |   |
|Tree                    |✓ |   |   |
|Vending Machine         |   |   |   |
|Vendor Cart             |   |   |   |

### Leashes

|Name                           |Chunks Per Map, est.|
|:------------------------------|-------------------:|
|Homesick & Tired               |- NPCs leash to their chunks at a disatance of 0 - i.e., they will not chase you further than its boundary.
|Roamin' Orgy                   |- NPCs no longer leash to their chunks. They will roam the entire level to chase you.

### Map Generation Overhaul

|Name                           |Effects|
|:------------------------------|:------|
|AnCapistan                     |- Disable law enforcment chunks & roaming NPCs<br>- Mandate criminal chunks & roaming NPCs<br>- Mandate Pollution features<br>- Disable Public Good features<br>- Toilets cost money
|Police State                   |- Mandte law enforcment chunks & roaming NPCs<br>- Disable criminal chunks & roaming NPCs<br>- Disable Pollution features<br>- Generate Law Enforcement-aligned Security Cameras in public

### Map Size *

Standard Chunk count for a map is 30.

|Name                           |Chunks Per Map, est.|
|:------------------------------|-------------------:|
|A City for Ants?!              |4
|Claustrophobia                 |12
|Megalopolis                    |48
|Ultrapolis                     |64

### Population *

|Name                           |Roaming NPC Multiplier|
|:------------------------------|---------------------:|
|Ghost Town                     | 0 %
|Let Me See That Throng         | 400 %
|Swarm Welcome                  | 800 %

### Quest Count *

|Name                           |Force Quest Count Per Floor|
|:------------------------------|--------------------------:|
|Rushin' Revolution             |0
|Single-Minded                  |1
|Workhorse                      |4

### Quest Rewards *

|Name                           |Quest Rewards|
|:------------------------------|:------------|
|Double-Ply Rewards             |Free Item or Hire Vouchers
|Unpaid Internship              |Double XP only

### Roamers

|Name                           |Effect|
|:------------------------------|:-----|
|Hoodlum's Wonderland           |- Roaming Gang numbers increased (12 gangs for standard floor size)
|Mob Town                       |- Mafia Spawn in all Districts
|Young Men in the Neighborhood  |- Roaming Gangs spawn in all Districts

### Walls & Floors *

*N.B.: If a chunk uses non-randomized walls or non-neutral floors, they will not be affected by these mutators.*

*N.B: These are compatible with Floors & Features mods, but the latter takes precedent on defining floors.*

|Name                           |Effect|
|:------------------------------|:-----|
|City of Steel                  |- All randomized walls will spawn as Steel.<br>- Neutral floors will spawn as Steel.
|Green Living                   |- All randomized walls will spawn as Hedge.<br>- Neutral floors will spawn as Grass.
|Panoptikopolis                 |- All randomized walls will spawn as Glass.<br>- Neutral floors will spawn as Steel.
|Shanty Town                    |- All randomized walls will spawn as Wood.<br>- Neutral floors will spawn as Dirt.
|Spelunky Dory                  |- All randomized walls will spawn as Cave Wall.<br>- Neutral floors will spawn as Cave Floor.<br>- Boulders spawn in all districts.

---

## Traits

### Additions

#### Experience Gain Rate

|Name                           |Value  |Experience Gain Rate|
|:------------------------------|------:|-------------------:|
|Dim Bulb                       |- 4    |75 %
|Moronic                        |- 8    |50 %
|Smooth-Brained                 |- 16   |0 %
|Very Hard-On Yourself          |- 2    |XP Loss 200 %

#### Miscellaneous

|Name                           |Value  |Camera Zoom Level|
|:------------------------------|------:|----------------:|
|Eagle Eyes                     |3      |60 %
|Eagle Eyes +                   |6      |40 %
|Myopic                         |- 4    |150 %
|Myopic +                       |- 8    |200 %

#### Social

|Name                           |Value  |Effect|
|:------------------------------|------:|:-----|
|Domineering                    |2      |- 10% chance for NPC to be Submissive
|Domineering +                  |4      |- 20% chance for NPC to be Submissive
|Generally Unpleasant           |- 3    |- All NPCs have a 20% chance to start out Annoyed with you.
|Objectively Unpleasant         |- 8    |- All NPCs start out Annoyed.
|Polarizing                     |0      |- All NPCs start out either Annoyed or Friendly.
|Polarizing +                   |1      |- All NPCS start out Hostile, Annoyed, Friendly, Loyal, or Aligned.
|Veiled Threats                 |3      |- When you attempt to Bribe, Extort, Mug, or Threaten, a failure will turn the target Annoyed instead of Hostile.
|Warlord                        |16     |- You can make anyone Submissive by damaging them enough.

#### Spawns

|Name                           |Value  |Effect|
|:------------------------------|------:|:-----|
|Haunted                        |- 2    |- Three hostile ghosts spawn in each level, and search for you.
|Mob Debt                       |- 10   |- Start with a $1,000 Debt. Remove it at the Upgrade Machine.<br>- If you still have this trait at Level 10, the Mafia will send Hit Squads after you.
|Mook Masher                    |- 4    |- An increasing number of armed and hostile Goons will try to track you down on each level. 
|Reinforcements                 |5      |- Spawns three Aligned Resistance Leaders, who roam the level and defend you.
|Reinforcements +               |10     |- Your allies are now armed and armored.

#### Stealth

|Name                           |Value  |Effect|
|:------------------------------|------:|:-----|
|Underdark Citizen              |2      |- Thieves and Cannibals hiding in Manholes no longer target you<br>- Activate or Fall in Open Manhole: Take no damage and teleport to another open Manhole<br>- Manholes spawn in all Districts

### Adjustments

|Name                           |Change(s)|
|:------------------------------|:--------|


## Object Interactions
- Manhole
  - Activate: Use Crowbar(15) to open